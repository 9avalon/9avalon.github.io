---
title : MySQL技术内幕——InnoDB存储引擎
date : 2016-10-30 00:55:19
---


## 锁

1、讲解的B+tree例子不错，深入浅出，强烈推荐

2、关于死锁的问题，除了AB-BA这种互相等待的死锁外，还有另外一种死锁

* 当前事务持有了待插入记录下一个记录的X锁，但是在等待队列中存在一个S锁的请求

3、锁升级，粒度从行到页再到表，从细到粗

* 升级锁是因为锁的开销比较大，系统需要使用较多内存维护锁。但是升级锁同时并发性能会降低。 
* InnoDB不存在锁升级的问题，因为其是根据事务访问的每个页对锁进行管理的。即页锁。

4、如果一个列里面重复数据特别多，那就不适合加索引。

## 关于索引
1、索引要建立在区分度较大的字段上，如果是那种只有0 1 2的就不要建立索引了，可以考虑建联合索引

2、联合索引要把区分度大的放前面，如联合索引AB，如果只查B的话是不会走索引的。只有查 A或者AB会走索引