<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>(Hard)单词搜索 II - Miguel's Wiki</title>
    <meta name="keywords" content=""/>
    <meta name="description" content="Miguel个人wiki"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="referrer" content="no-referrer" />
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/wiki/">Home</a>&nbsp;&#187;&nbsp;<a href="/wiki/#算法">算法</a>&nbsp;&#187;&nbsp;(Hard)单词搜索 II
    <span class="updated">Page Updated&nbsp;
      2020-02-08 12:54:25
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">(Hard)单词搜索 II</div>

  <div class="hlcode"><pre><span class="err">给定一个二维网格</span> <span class="nt">board</span> <span class="err">和一个字典中的单词列表</span> <span class="nt">words</span><span class="err">，找出所有同时在二维网格和字典中出现的单词。</span>

<span class="err">单词必须按照字母顺序，通过相邻的单元格内的字母构成，其中“相邻”单元格是那些水平相邻或垂直相邻的单元格。同一个单元格内的字母在一个单词中不允许被重复使用。</span>

<span class="err">示例</span><span class="o">:</span>

<span class="err">输入</span><span class="o">:</span> 
<span class="nt">words</span> <span class="o">=</span> <span class="cp">[</span><span class="s2">&quot;oath&quot;</span><span class="p">,</span><span class="s2">&quot;pea&quot;</span><span class="p">,</span><span class="s2">&quot;eat&quot;</span><span class="p">,</span><span class="s2">&quot;rain&quot;</span><span class="cp">]</span> <span class="nt">and</span> <span class="nt">board</span> <span class="o">=</span>
<span class="cp">[</span>
  <span class="err">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="cp">]</span><span class="o">,</span>
  <span class="cp">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="cp">]</span><span class="o">,</span>
  <span class="cp">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="cp">]</span><span class="o">,</span>
  <span class="cp">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="cp">]</span>
<span class="o">]</span>

<span class="err">输出</span><span class="o">:</span> <span class="cp">[</span><span class="s2">&quot;eat&quot;</span><span class="p">,</span><span class="s2">&quot;oath&quot;</span><span class="cp">]</span>
<span class="err">说明</span><span class="o">:</span>
<span class="err">你可以假设所有输入都由小写字母</span> <span class="nt">a-z</span> <span class="err">组成。</span>

<span class="err">提示</span><span class="o">:</span>

<span class="err">你需要优化回溯算法以通过更大数据量的测试。你能否早点停止回溯？</span>
<span class="err">如果当前单词不存在于所有单词的前缀中，则可以立即停止回溯。什么样的数据结构可以有效地执行这样的操作？散列表是否可行？为什么？</span> <span class="err">前缀树如何？如果你想学习如何实现一个基本的前缀树，请先查看这个问题：</span> <span class="err">实现</span><span class="nt">Trie</span><span class="err">（前缀树）。</span>
</pre></div>


<p>自己题解:</p>
<div class="hlcode"><pre><span class="kd">class</span> <span class="nc">Solution</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Solution</span><span class="o">[]</span> <span class="n">children</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Solution</span><span class="o">[</span><span class="mi">26</span><span class="o">];</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isEnd</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">findWords</span><span class="o">(</span><span class="kt">char</span><span class="o">[][]</span> <span class="n">board</span><span class="o">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">words</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 初始化前缀树</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">words</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">insert</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">board</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">y</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">board</span><span class="o">[</span><span class="n">y</span><span class="o">].</span><span class="na">length</span><span class="o">;</span> <span class="n">x</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">dfs</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">board</span><span class="o">,</span> <span class="n">words</span><span class="o">,</span> <span class="n">res</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">dfs</span><span class="o">(</span><span class="n">String</span> <span class="n">temp</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">,</span> <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">char</span><span class="o">[][]</span> <span class="n">board</span><span class="o">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">words</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">res</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">road</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">board</span><span class="o">.</span><span class="na">length</span> <span class="o">||</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">board</span><span class="o">[</span><span class="n">y</span><span class="o">].</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">temp</span> <span class="o">+=</span> <span class="n">board</span><span class="o">[</span><span class="n">y</span><span class="o">][</span><span class="n">x</span><span class="o">];</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">startsWith</span><span class="o">(</span><span class="n">temp</span><span class="o">)</span> <span class="o">||</span> <span class="n">road</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">y</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="n">x</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">search</span><span class="o">(</span><span class="n">temp</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">res</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">temp</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">res</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">temp</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">road</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">y</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="n">x</span><span class="o">);</span>
        <span class="n">dfs</span><span class="o">(</span><span class="n">temp</span><span class="o">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">board</span><span class="o">,</span> <span class="n">words</span><span class="o">,</span> <span class="n">res</span><span class="o">,</span> <span class="n">road</span><span class="o">);</span> <span class="c1">// 上</span>
        <span class="n">dfs</span><span class="o">(</span><span class="n">temp</span><span class="o">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">board</span><span class="o">,</span> <span class="n">words</span><span class="o">,</span> <span class="n">res</span><span class="o">,</span> <span class="n">road</span><span class="o">);</span> <span class="c1">// 下</span>
        <span class="n">dfs</span><span class="o">(</span><span class="n">temp</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">board</span><span class="o">,</span> <span class="n">words</span><span class="o">,</span> <span class="n">res</span><span class="o">,</span> <span class="n">road</span><span class="o">);</span> <span class="c1">// 左</span>
        <span class="n">dfs</span><span class="o">(</span><span class="n">temp</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">board</span><span class="o">,</span> <span class="n">words</span><span class="o">,</span> <span class="n">res</span><span class="o">,</span> <span class="n">road</span><span class="o">);</span> <span class="c1">// 右 </span>
        <span class="n">road</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">road</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/** Inserts a word into the trie. */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insert</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Solution</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">word</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">temp</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">word</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">temp</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">word</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Solution</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">word</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">isEnd</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/** Returns if there is any word in the trie that starts with the given prefix. */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">startsWith</span><span class="o">(</span><span class="n">String</span> <span class="n">prefix</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Solution</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">prefix</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">temp</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">prefix</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">prefix</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">search</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Solution</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">word</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">temp</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">word</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">children</span><span class="o">[</span><span class="n">word</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">temp</span><span class="o">.</span><span class="na">isEnd</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>分析:</p>
<p>提交了好多好多次，需要注意的点有</p>
<p>1.实现前缀树，以快速剪枝</p>
<p>2.要记录每一步dfs的值，避免死循环dfs</p>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2020 Miguel.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2020-06-04 14:06:19</p>
      </span>
    </div>

    
    
  </body>
</html>