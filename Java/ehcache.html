
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../static/favicon.ico">

    <title>ehcache - 9avalon wiki</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/css/jumbotron-narrow.css" rel="stylesheet">
    <link href="../static/css/style.css" rel="stylesheet">
	<link href="../static/css/tango.css" rel="stylesheet">
</head>

<body>

<div class="container">
	<ol class="breadcrumb">	
		<li><a href="/">Home</a></li><li><a href="/#Java">Java</a></li><li class="active">ehcache</li>
    </ol>
	
    <div class="header clearfix">
        <nav>
            <ul class="nav nav-pills pull-right">
            </ul>
        </nav>
        <h3 class="text-muted">ehcache</h3>
    </div>

    <div class="row wiki-main">
		<p>一款优秀的缓存框架
下面是XML配置文件,一般放在程序的目录下，程序会自动寻找</p>
<div class="hlcode"><pre><span class="nt">&lt;ehcache</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">&quot;../config/ehcache.xsd&quot;</span><span class="nt">&gt;</span>  
    <span class="nt">&lt;diskStore</span> <span class="na">path=</span><span class="s">&quot;java.io.tmpdir&quot;</span><span class="nt">/&gt;</span>  
    <span class="c">&lt;!--  </span>
<span class="c">    Mandatory Default Cache configuration. These settings will be applied to caches  </span>
<span class="c">    created programmtically using CacheManager.add(String cacheName)  </span>
<span class="c">    --&gt;</span>  
    <span class="c">&lt;!--  </span>
<span class="c">       name:缓存名称。  </span>
<span class="c">       maxElementsInMemory：缓存最大个数。  </span>
<span class="c">       eternal:对象是否永久有效，一但设置了，timeout将不起作用。  </span>
<span class="c">       timeToIdleSeconds：设置对象在失效前的允许闲置时间（单位：秒）。仅当eternal=false对象不是永久有效时使用，可选属性，默认值是0，也就是可闲置时间无穷大。  </span>
<span class="c">       timeToLiveSeconds：设置对象在失效前允许存活时间（单位：秒）。最大时间介于创建时间和失效时间之间。仅当eternal=false对象不是永久有效时使用，默认是0.，也就是对象存活时间无穷大。  </span>
<span class="c">       overflowToDisk：当内存中对象数量达到maxElementsInMemory时，Ehcache将会对象写到磁盘中。  </span>
<span class="c">       diskSpoolBufferSizeMB：这个参数设置DiskStore（磁盘缓存）的缓存区大小。默认是30MB。每个Cache都应该有自己的一个缓冲区。  </span>
<span class="c">       maxElementsOnDisk：硬盘最大缓存个数。  </span>
<span class="c">       diskPersistent：是否缓存虚拟机重启期数据 Whether the disk store persists between restarts of the Virtual Machine. The default value is false.  </span>
<span class="c">       diskExpiryThreadIntervalSeconds：磁盘失效线程运行时间间隔，默认是120秒。  </span>
<span class="c">       memoryStoreEvictionPolicy：当达到maxElementsInMemory限制时，Ehcache将会根据指定的策略去清理内存。默认策略是LRU（最近最少使用）。你可以设置为FIFO（先进先出）或是LFU（较少使用）。  </span>
<span class="c">       clearOnFlush：内存数量最大时是否清除。  </span>
<span class="c">    --&gt;</span>  
    <span class="nt">&lt;defaultCache</span>  
            <span class="na">maxElementsInMemory=</span><span class="s">&quot;10000&quot;</span>  
            <span class="na">eternal=</span><span class="s">&quot;false&quot;</span>  
            <span class="na">timeToIdleSeconds=</span><span class="s">&quot;120&quot;</span>  
            <span class="na">timeToLiveSeconds=</span><span class="s">&quot;120&quot;</span>  
            <span class="na">overflowToDisk=</span><span class="s">&quot;true&quot;</span>  
            <span class="na">maxElementsOnDisk=</span><span class="s">&quot;10000000&quot;</span>  
            <span class="na">diskPersistent=</span><span class="s">&quot;false&quot;</span>  
            <span class="na">diskExpiryThreadIntervalSeconds=</span><span class="s">&quot;120&quot;</span>  
            <span class="na">memoryStoreEvictionPolicy=</span><span class="s">&quot;LRU&quot;</span>  
            <span class="nt">/&gt;</span>
    <span class="nt">&lt;cache</span> <span class="na">name=</span><span class="s">&quot;sampleCache1&quot;</span> 
           <span class="na">maxElementsInMemory=</span><span class="s">&quot;10000&quot;</span>
           <span class="na">maxElementsOnDisk=</span><span class="s">&quot;1000&quot;</span> 
           <span class="na">eternal=</span><span class="s">&quot;false&quot;</span> 
           <span class="na">overflowToDisk=</span><span class="s">&quot;true&quot;</span>
           <span class="na">diskSpoolBufferSizeMB=</span><span class="s">&quot;20&quot;</span>
           <span class="na">timeToIdleSeconds=</span><span class="s">&quot;300&quot;</span>
           <span class="na">timeToLiveSeconds=</span><span class="s">&quot;600&quot;</span>
           <span class="na">memoryStoreEvictionPolicy=</span><span class="s">&quot;LFU&quot;</span> <span class="nt">/&gt;</span>         
<span class="nt">&lt;/ehcache&gt;</span>  
</pre></div>


<div class="hlcode"><pre><span class="err">测试代码</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">cacheTest</span><span class="o">(){</span>
        <span class="n">String</span> <span class="n">cacheName</span> <span class="o">=</span> <span class="s">&quot;sampleCache1&quot;</span><span class="o">;</span>
        <span class="n">Cache</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="na">getCache</span><span class="o">(</span><span class="s">&quot;sampleCache1&quot;</span><span class="o">);</span>
        <span class="c1">//往cache中添加数据</span>
        <span class="n">Element</span> <span class="n">element</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Element</span><span class="o">(</span><span class="s">&quot;key&quot;</span><span class="o">,</span><span class="s">&quot;values&quot;</span><span class="o">);</span>  
        <span class="n">cache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
        <span class="c1">//往cache中取回数据</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;key&quot;</span><span class="o">);</span>  
        <span class="n">Object</span> <span class="n">valueObj</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="na">getObjectValue</span><span class="o">();</span>  
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">valueObj</span><span class="o">);</span>
        <span class="c1">//删除数据</span>
        <span class="n">cache</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="s">&quot;key&quot;</span><span class="o">);</span>
    <span class="o">}</span>
</pre></div>
    </div>

    <footer class="footer">
        <p style="font-size: 12px">Copyright © 2016 . Powered by Simiki. Theme by 9avalon</p>
    </footer>

</div> <!-- /container -->

</body>
</html>