<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>Javaå¹¶å‘ä¸“é¢˜ - å¿ƒä¹‹æ‰€åŠ¨ï¼Œä¸”å°±éšç¼˜è€Œå»å§</title>
    <meta name="keywords" content=""/>
    <meta name="description" content="ä¾¯é“­å¥çš„ä¸ªäººwiki"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/wiki/">Home</a>&nbsp;&#187;&nbsp;<a href="/wiki/#Book">Book</a>&nbsp;&#187;&nbsp;Javaå¹¶å‘ä¸“é¢˜
    <span class="updated">Page Updated&nbsp;
      2016-8-7 14:52
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">Javaå¹¶å‘ä¸“é¢˜</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">å¯¼è¯»</a></li>
<li><a href="#java">Javaå¹¶å‘åŸºç¡€</a><ul>
<li><a href="#_2">ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨</a></li>
<li><a href="#_3">ä¸²è¡Œå’Œå¹¶è¡Œ</a></li>
</ul>
</li>
<li><a href="#_4">å¸¸è§é”</a><ul>
<li><a href="#volatile">volatile</a></li>
<li><a href="#synchronized">synchronized</a></li>
<li><a href="#reentranlock">ReenTranLock</a></li>
<li><a href="#_5">é”é‡å…¥</a></li>
</ul>
</li>
<li><a href="#_6">åŸå­å˜é‡ç±»</a></li>
<li><a href="#_7">å¸¸è§çš„å¹¶å‘å·¥å…·ç±»</a><ul>
<li><a href="#countdownlatch">CountDownLatch</a></li>
<li><a href="#cyclicbarrier">CyclicBarrier</a></li>
<li><a href="#semaphore">Semaphoreï¼ˆä¿¡å·é‡ï¼‰</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="_1">å¯¼è¯»</h1>
<ul>
<li>Javaå¹¶å‘åŸºç¡€</li>
<li>å¹¶å‘é” </li>
<li>åŸå­æ“ä½œç±»</li>
<li>å¸¸è§çš„å¹¶å‘å·¥å…·ç±»</li>
</ul>
<h1 id="java">Javaå¹¶å‘åŸºç¡€</h1>
<h2 id="_2">ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨</h2>
<p>å½“å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®ä¸€ä¸ªç±»ã€æ–¹æ³•æˆ–å¯¹è±¡æ—¶ï¼Œå¦‚æœè¯¥ç±»å§‹ç»ˆèƒ½æ­£ç¡®æ‰§è¡Œï¼Œå¾—åˆ°æ­£ç¡®çš„ç»“æœï¼Œåˆ™è¯¥æ–¹æ³•å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<h2 id="_3">ä¸²è¡Œå’Œå¹¶è¡Œ</h2>
<p>å¹¶è¡Œä¸ä¸€å®šæ¯”ä¸²è¡Œå¿«ï¼Œå› ä¸ºçº¿ç¨‹æœ‰åˆ›å»ºå’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚ä¼šæœ‰ä¸´ç•Œç‚¹ã€‚</p>
<h1 id="_4">å¸¸è§é”</h1>
<h2 id="volatile">volatile</h2>
<p>volatileï¼Œæ¯” synchronizedæ›´è½»é‡çº§çš„å®ç°ï¼Œå®ƒä¿è¯äº†å¹¶å‘æ—¶ï¼Œå…±äº«å˜é‡çš„å¯è§æ€§ï¼Œå³ï¼Œä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å˜é‡ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹èƒ½è¯»åˆ°è¿™ä¸ªä¿®æ”¹çš„å€¼ï¼Œä½†æ˜¯ï¼Œå®ƒä¸èƒ½ä¿è¯æ“ä½œçš„ <strong>åŸå­æ€§</strong> ã€‚</p>
<p>å…±äº«å˜é‡ï¼šå¯ä»¥çœ‹åˆ°ï¼Œçº¿ç¨‹ä¸€èˆ¬å…ˆä»ä¸»å†…å­˜ä¸­æŠŠå˜é‡å–å‡ºï¼Œç„¶åå¤åˆ¶ä¸€ä¸ªå˜é‡å‰¯æœ¬åˆ°æœ¬åœ°å†…å­˜ä¸­ã€‚å†è¿›è¡Œæ“ä½œï¼Œå¦‚æœå˜é‡è¢«å£°æ˜äº†volatileï¼Œåˆ™æ¯æ¬¡è¿™ä¸ªå€¼çš„ä¿®æ”¹ï¼Œéƒ½ä¼šä½¿æœ¬åœ°å†…å­˜çš„å‰¯æœ¬å¤±æ•ˆï¼Œçº¿ç¨‹éœ€è¦ä»ä¸»å†…å­˜ä¸­é‡æ–°è·å–å€¼ã€‚å³å£°æ˜äº†volatileçš„å˜é‡å¯ä»¥ä½¿å€¼æ˜¯å†…å­˜ä¸­æœ€æ–°çš„å€¼ã€‚</p>
<p><img alt="å…±äº«å˜é‡" src="http://ww4.sinaimg.cn/large/005H7Wvyjw1f9pdmcjay2j30cs0avgmy.jpg" /></p>
<h2 id="synchronized">synchronized</h2>
<p>synchronizedåœ¨java6ä¹‹å‰å¾ˆå¤šäººéƒ½ç§°å‘¼å…¶ä¸ºâ€œé‡é‡çº§é”â€ï¼Œä½†æ˜¯éšç€javaåé¢çš„æŒç»­ä¼˜åŒ–ï¼Œsynchronizedçš„æ€§èƒ½å·²ç»æ¯”ä»¥å‰æœ‰äº†å¾ˆå¤§çš„æå‡ã€‚</p>
<p>synchronizedæ˜¯å¯¹è±¡é”ï¼Œå¦‚æœç±»ä¸­ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯è¢«synchronizedä¿®é¥°ï¼Œå½“å¹¶å‘è®¿é—®æ—¶ï¼Œä¼šäº’ç›¸ç­‰å¾…ã€‚</p>
<p>synchronizedæœ‰å¥½å‡ ç§ç”¨æ³•</p>
<p>1.ç»™æ–¹æ³•åŠ </p>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">sum</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">dosomething</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>


<p>åŠ é”åï¼ŒåŒä¸€ä¸ªå®ä¾‹ï¼Œå¤šä¸ªçº¿ç¨‹å¹¶å‘æ—¶ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è¿›å…¥è¯¥æ–¹æ³•å¹¶æ‰§è¡Œ</p>
<p>2.ç»™é™æ€æ–¹æ³•åŠ </p>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">sum</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">dosomething</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>


<p>åŠ é”åï¼Œæ‰€æœ‰å®ä¾‹ï¼Œå¤šä¸ªçº¿ç¨‹å¹¶å‘æ—¶ï¼Œéƒ½åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è¿›å…¥è¯¥æ–¹æ³•å¹¶æ‰§è¡Œ</p>
<p>3.æ–¹æ³•ä½“ä¸­åŠ å…¥<br />
<br />
synchronized()é‡Œé¢æ—¢å¯ä»¥ä¼ ç±»ï¼Œä¹Ÿå¯ä»¥ä¼ å®ä¾‹ï¼Œä¼ ç±»å°±æ˜¯ç±»é”ï¼Œä¼ å®ä¾‹å°±æ˜¯å¯¹è±¡é”ã€‚å¦‚ä¸‹é¢çš„ä»£ç ä¾‹å­ï¼Œè‹¥åˆ†åˆ«ä½¿ç”¨ç±»é”å’Œå¯¹è±¡é”ï¼Œä¸¤è€…æ˜¯ä¸ä¼šäº’ç›¸é˜»å¡çš„ã€‚</p>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Entity</span> <span class="o">{</span>
    <span class="o">......</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">synchronized</span> <span class="o">(</span><span class="n">Entity</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">dosomething</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">synchronized</span> <span class="o">(</span><span class="k">new</span> <span class="n">Entity</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">dosomething</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h2 id="reentranlock">ReenTranLock</h2>
<p>ä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„å¹¶å‘æ§åˆ¶é”ï¼Œæ¯”syncronizedçµæ´»ï¼Œå¯ä»¥æ§åˆ¶çš„ç²’åº¦æ›´å°ã€‚</p>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReenTranLockDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">ReentrantLock</span> <span class="n">reentrantLock</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ReentrantLock</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">new</span> <span class="nf">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="n">reentrantLock</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>

                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;æ‰§è¡Œä¸šåŠ¡ä¸­.........&quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="n">Date</span><span class="o">());</span>

                    <span class="k">try</span> <span class="o">{</span>
                        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="o">}</span>

                    <span class="n">reentrantLock</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}).</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>è¾“å‡ºå¦‚ä¸‹:</p>
<div class="hlcode"><pre><span class="err">æ‰§è¡Œä¸šåŠ¡ä¸­</span><span class="o">.........</span><span class="na">Sun</span> <span class="n">Jul</span> <span class="mi">15</span> <span class="mi">12</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">07</span> <span class="n">CST</span> <span class="mi">2018</span>
<span class="err">æ‰§è¡Œä¸šåŠ¡ä¸­</span><span class="o">.........</span><span class="na">Sun</span> <span class="n">Jul</span> <span class="mi">15</span> <span class="mi">12</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">08</span> <span class="n">CST</span> <span class="mi">2018</span>
<span class="err">æ‰§è¡Œä¸šåŠ¡ä¸­</span><span class="o">.........</span><span class="na">Sun</span> <span class="n">Jul</span> <span class="mi">15</span> <span class="mi">12</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">09</span> <span class="n">CST</span> <span class="mi">2018</span>
<span class="err">æ‰§è¡Œä¸šåŠ¡ä¸­</span><span class="o">.........</span><span class="na">Sun</span> <span class="n">Jul</span> <span class="mi">15</span> <span class="mi">12</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mi">10</span> <span class="n">CST</span> <span class="mi">2018</span>
</pre></div>


<h2 id="_5">é”é‡å…¥</h2>
<p>åŒä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœå·²ç»è·å–åˆ°é”åï¼Œè¦ç»§ç»­è·å–é”æ—¶ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œï¼Œä¸éœ€è¦å†è·å–é”ã€‚synchronizedæ˜¯æ”¯æŒé”é‡å…¥çš„ã€‚</p>
<h1 id="_6">åŸå­å˜é‡ç±»</h1>
<p>AtomicInegerï¼ŒAtomicLongï¼Œç­‰ç­‰</p>
<p>çº¿ç¨‹å®‰å…¨ï¼Œå†…éƒ¨æœ‰é”ï¼Œå¯ä»¥ä½œä¸ºå…¨å±€å˜é‡æ¥è¿›è¡Œå†…éƒ¨æ“ä½œï¼Œå¦‚è‡ªå¢ã€‚</p>
<p>æ‰©å±•ï¼šç›®å‰é¡¹ç›®ä¸­ä¸€èˆ¬å¾ˆå°‘ç”¨åˆ°åŸå­å˜é‡ç±»ï¼Œå› ä¸ºç°åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸€èˆ¬éƒ½æ˜¯åˆ†å¸ƒå¼äº†ï¼Œå‡ ä¹ä¸ä¼šå•æœºè·‘ï¼Œè€Œåˆ†å¸ƒå¼ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨redisæ¥ä½œä¸ºè‡ªå¢é”æ¥ä½¿ç”¨ã€‚</p>
<h1 id="_7">å¸¸è§çš„å¹¶å‘å·¥å…·ç±»</h1>
<h2 id="countdownlatch">CountDownLatch</h2>
<p>CountDownLatchå¯ä»¥å®ç°ç±»ä¼¼å€’è®¡æ—¶çš„åŠŸèƒ½ï¼Œé€šè¿‡è°ƒç”¨ <strong>countDown</strong> æ¥å®ç°å‡ä¸€çš„åŠŸèƒ½ï¼Œå½“CountDownLatché‡Œé¢çš„è®¡æ•°å™¨å‡åˆ°0æ—¶ï¼Œä¹‹å‰awaitæŒ‚èµ·çš„çº¿ç¨‹ï¼Œå°±èƒ½ç»§ç»­æ‰§è¡Œã€‚</p>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountDownLatchDemo</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">CountDownLatch</span> <span class="n">countDownLatch</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CountDownLatch</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getId</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;-- å¼€å§‹&quot;</span><span class="o">);</span>
                    <span class="n">countDownLatch</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span>

                    <span class="k">try</span> <span class="o">{</span>
                        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000L</span><span class="o">);</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="o">}</span>

                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getId</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;-- ç»“æŸ&quot;</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">});</span>
            <span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;ä¸»çº¿ç¨‹ç­‰å¾…å¼€å§‹............&quot;</span><span class="o">);</span>
        <span class="n">countDownLatch</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;ä¸»çº¿ç¨‹ç­‰å¾…ç»“æŸ............&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>æ‰§è¡Œç»“æœ</p>
<div class="hlcode"><pre><span class="mi">10</span><span class="o">--</span> <span class="err">å¼€å§‹</span>
<span class="mi">11</span><span class="o">--</span> <span class="err">å¼€å§‹</span>
<span class="mi">12</span><span class="o">--</span> <span class="err">å¼€å§‹</span>
<span class="mi">13</span><span class="o">--</span> <span class="err">å¼€å§‹</span>
<span class="mi">14</span><span class="o">--</span> <span class="err">å¼€å§‹</span>
<span class="err">ä¸»çº¿ç¨‹ç­‰å¾…å¼€å§‹</span><span class="o">............</span>
<span class="mi">15</span><span class="o">--</span> <span class="err">å¼€å§‹</span>
<span class="err">ä¸»çº¿ç¨‹ç­‰å¾…ç»“æŸ</span><span class="o">............</span>
<span class="mi">10</span><span class="o">--</span> <span class="err">ç»“æŸ</span>
<span class="mi">11</span><span class="o">--</span> <span class="err">ç»“æŸ</span>
<span class="mi">12</span><span class="o">--</span> <span class="err">ç»“æŸ</span>
<span class="mi">13</span><span class="o">--</span> <span class="err">ç»“æŸ</span>
<span class="mi">14</span><span class="o">--</span> <span class="err">ç»“æŸ</span>
<span class="mi">15</span><span class="o">--</span> <span class="err">ç»“æŸ</span>
</pre></div>


<h2 id="cyclicbarrier">CyclicBarrier</h2>
<p>CyclicBarrierå¯ä»¥åº”ç”¨åœ¨è¿™ç§åœºæ™¯ã€‚</p>
<p>ä»»åŠ¡åˆ†å‘ç»™å„ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œå„ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œåï¼Œä¸»çº¿ç¨‹å†è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚</p>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ä¿®æ•°æ®æ—¶ï¼Œè¦ä¿®å‡ ç™¾ä¸‡ä¸Šåƒä¸‡çš„æ•°æ®ï¼Œéœ€è¦ç”¨å¤šçº¿ç¨‹è·‘ç¼©çŸ­æ—¶é—´ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨CyclicBarrieræ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆä»»åŠ¡</p>
<p>é¦–å…ˆåœ¨ä¸»çº¿ç¨‹å°†ä»»åŠ¡åˆ†ç‰‡ï¼Œåˆ†ç‰‡å®Œæ¯•åï¼Œå„ä¸ªåˆ†ç‰‡çš„æ•°æ®äº¤ç»™å„ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œä¸»çº¿ç¨‹å†åšé€»è¾‘åˆ¤æ–­ï¼Œé‡æ–°åˆ†ç‰‡æ‰§è¡Œã€‚</p>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CyclicBarrierDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">CyclicBarrier</span> <span class="n">cyclicBarrier</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CyclicBarrier</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">BrokenBarrierException</span><span class="o">,</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>

                        <span class="c1">// dosomething()</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getId</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;[çº¿ç¨‹å®Œæˆä½œä¸š]&quot;</span><span class="o">);</span>

                        <span class="n">cyclicBarrier</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">});</span>
            <span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;ä¸»çº¿ç¨‹ç­‰å¾…çº¿ç¨‹ä½œä¸šå®Œæˆ..........&quot;</span><span class="o">);</span>

        <span class="n">cyclicBarrier</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;ä¸»çº¿ç¨‹å¼€å§‹ä½œä¸š =&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;</span><span class="o">);</span>
        <span class="c1">// dosomething()</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>è¾“å‡ºç»“æœ</p>
<div class="hlcode"><pre><span class="err">ä¸»çº¿ç¨‹ç­‰å¾…çº¿ç¨‹ä½œä¸šå®Œæˆ</span><span class="o">..........</span>
<span class="mi">10</span><span class="o">[</span><span class="err">çº¿ç¨‹å®Œæˆä½œä¸š</span><span class="o">]</span>
<span class="mi">11</span><span class="o">[</span><span class="err">çº¿ç¨‹å®Œæˆä½œä¸š</span><span class="o">]</span>
<span class="err">ä¸»çº¿ç¨‹å¼€å§‹ä½œä¸š</span> <span class="o">=&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</pre></div>


<h2 id="semaphore">Semaphoreï¼ˆä¿¡å·é‡ï¼‰</h2>
<p>å¯ä»¥ç”¨æ¥æ§åˆ¶å•æœºå¹¶å‘ï¼Œä¼šé˜»å¡ã€‚</p>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SemaphoreDemo</span> <span class="o">{</span>

    <span class="c1">// åˆå§‹åŒ–å®¹é‡ä¸º2çš„ä¿¡å·é‡</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Semaphore</span> <span class="n">semaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Semaphore</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>

    <span class="cm">/**</span>
<span class="cm">     * åªå…è®¸ä¸¤ä¸ªå¹¶å‘çš„æ–¹æ³•</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">acceptTwoThreadMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">semaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>

            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;ä¸šåŠ¡æ‰§è¡Œä¸­.........&quot;</span><span class="o">);</span>
            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000L</span><span class="o">);</span>

            <span class="n">semaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>

        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                    <span class="n">acceptTwoThreadMethod</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">});</span>
            <span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
    </div>
    <div id="footer">
      <span>
        <p>Copyright Â© 2018 ä¾¯é“­å¥.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2018-07-15 13:21:22</p>
      </span>
    </div>

    
    
  </body>
</html>