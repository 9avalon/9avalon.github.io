
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../static/favicon.ico">

    <title>sql语句记录 - 9avalon wiki</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/css/jumbotron-narrow.css" rel="stylesheet">
    <link href="../static/css/style.css" rel="stylesheet">
	<link href="../static/css/tango.css" rel="stylesheet">
</head>

<body>

<div class="container">
	<ol class="breadcrumb">	
		<li><a href="/">Home</a></li><li><a href="/#数据库">数据库</a></li><li class="active">sql语句记录</li>
    </ol>
	
    <div class="header clearfix">
        <nav>
            <ul class="nav nav-pills pull-right">
            </ul>
        </nav>
        <h3 class="text-muted">sql语句记录</h3>
    </div>

    <div class="row wiki-main">
		<div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">函数</a><ul>
<li><a href="#concat">CONCAT——连接字符串</a></li>
<li><a href="#date_format">DATE_FORMAT——字符串转日期</a></li>
<li><a href="#date_add">DATE_ADD ——增加日期</a></li>
<li><a href="#date_sub">DATE_SUB —— 减少日期</a></li>
</ul>
</li>
<li><a href="#_2">查询重复</a></li>
<li><a href="#_3">存储过程</a></li>
<li><a href="#save-or-update">SAVE OR UPDATE</a></li>
</ul>
</div>
<h4 id="_1">函数</h4>
<h5 id="concat">CONCAT——连接字符串</h5>
<div class="hlcode"><pre><span class="n">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">table</span> <span class="n">where</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">str2</span><span class="p">,</span> <span class="p">......)</span>
</pre></div>


<h5 id="date_format">DATE_FORMAT——字符串转日期</h5>
<div class="hlcode"><pre><span class="n">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">table</span> <span class="n">where</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">now</span><span class="p">(),</span> <span class="err">`</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">d</span><span class="err">`</span><span class="p">)</span>

<span class="o">%</span><span class="n">Y</span><span class="err">：年</span>
<span class="o">%</span><span class="n">c</span><span class="err">：月</span>
<span class="o">%</span><span class="n">d</span><span class="err">：日</span>
<span class="o">%</span><span class="n">H</span><span class="err">：小时</span>
<span class="o">%</span><span class="n">i</span><span class="err">：分钟</span>
<span class="o">%</span><span class="n">s</span><span class="err">：秒</span>
</pre></div>


<p>还有很多扩展的写法，如小写的y是两位数的年份等等。</p>
<h5 id="date_add">DATE_ADD ——增加日期</h5>
<div class="hlcode"><pre><span class="k">select</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">now</span><span class="p">(),</span><span class="nb">INTERVAL</span> <span class="mi">2</span> <span class="k">DAY</span><span class="p">)</span>   <span class="o">//</span> <span class="err">增加两天的时间</span>
</pre></div>


<h5 id="date_sub">DATE_SUB —— 减少日期</h5>
<div class="hlcode"><pre><span class="k">select</span> <span class="n">DATE_SUB</span><span class="p">(</span><span class="n">now</span><span class="p">(),</span><span class="nb">INTERVAL</span> <span class="mi">2</span> <span class="n">HOUR</span><span class="p">)</span> <span class="o">//</span> <span class="err">减少两个小时</span>
</pre></div>


<h4 id="_2">查询重复</h4>
<div class="hlcode"><pre><span class="k">select</span> <span class="n">order_id</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="k">count</span> <span class="k">from</span> <span class="n">t_order</span> <span class="k">group</span> <span class="k">by</span> <span class="n">order_id</span> <span class="k">having</span> <span class="k">count</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">;</span>
</pre></div>


<h4 id="_3">存储过程</h4>
<p>1、传入参数是varchar类型时要注意，传入参数要带 '', 不然参数不能识别</p>
<h4 id="save-or-update">SAVE OR UPDATE</h4>
<div class="hlcode"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="k">table</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="ss">&quot;A&quot;</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span>    
<span class="n">name</span><span class="o">=</span><span class="ss">&quot;A&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">19</span>
</pre></div>
    </div>

    <footer class="footer">
        <p style="font-size: 12px">Copyright © 2016 . Powered by Simiki. Theme by 9avalon</p>
    </footer>

</div> <!-- /container -->

</body>
</html>